{
  "id": "dental-data-field-structure",
  "title": "Data Field Structure",
  "text": "# Data Field Structure\n\n**Document Type:** data-field-structure\n**Business Type:** dental\n\n---\n\n## IMPORTANT: Structura Datelor în Resurse\n\n**TOATE datele resursei merg în câmpul 'data'.** resourceId este generat automat de sistem.\n\n### Când Creezi Resurse:\n```\ncall_frontend_function('createResource', {\n  resourceType: '...',\n  data: {...}  // TOATE câmpurile custom aici\n})\n```\n\n### Când Actualizezi Resurse:\n```\ncall_frontend_function('updateResource', {\n  resourceType: '...',\n  resourceId: '...',\n  data: {...}  // TOATE câmpurile actualizate aici\n})\n```\n\n### Când Interogezi Resurse:\n\nFolosești **dot notation** pentru a filtra după câmpuri din 'data':\n\n**Exemple:**\n- `'data.patientName'` - câmp simplu în data\n- `'data.patient.name'` - câmp nested (obiect în obiect)\n- `'data.doctor.name'` - alt câmp nested\n- `'data.services[].name'` - câmp în array\n- `'data.status'` - câmp simplu\n\n**Query Example:**\n```\nquery_resources(\n  resourceType: 'appointment',\n  action: 'list',\n  params: {\n    'data.patient.name': 'Maria Ionescu',\n    'data.status': 'scheduled'\n  }\n)\n```\n\n## CÂMPURI TOP-LEVEL (NU în data):\n\nAcestea sunt câmpuri auto-generate și NU merg în data:\n- `businessId` - Auto-generated\n- `locationId` - Auto-generated\n- `resourceId` - Auto-generated (sau UUID generat de sistem)\n- `resourceType` - Specificat de tine\n- `timestamp` - Auto-generated\n- `startDate` - Pentru appointments, ACEST CÂMP este TOP-LEVEL!\n- `endDate` - Pentru appointments, folosit în range queries\n- `createdAt` - Auto-generated\n- `updatedAt` - Auto-generated\n\n**IMPORTANT pentru startDate/endDate:**\nAcestea NU sunt în data.*, sunt câmpuri top-level separate!\n\n**Corect:**\n```\nparams: {\n  startDate: '2025-10-20',\n  endDate: '2025-10-30'\n}\n```\n\n**Greșit:**\n```\nparams: {\n  'data.startDate': '2025-10-20'  // NU!\n}\n```\n\n## STRUCTURI NESTED IMPORTANTE:\n\n### Pentru Appointments:\n\n**Noua structură (PREFERRED):**\n```\ndata: {\n  date: '2025-10-20',\n  time: '14:00',\n  patient: {\n    id: 'pa2508-00015',\n    name: 'Maria Ionescu'\n  },\n  doctor: {\n    id: 'uuid-doctor',\n    name: 'Dr. Popescu'\n  },\n  services: [  // ARRAY - PLURAL!\n    {\n      id: 'tr2508-00001',\n      name: 'Consultatie',\n      duration: 30,\n      price: 150\n    },\n    {\n      id: 'tr2508-00002',\n      name: 'Detartraj',\n      duration: 45,\n      price: 200\n    }\n  ],\n  price: 350,  // Total\n  status: 'scheduled'\n}\n```\n\n**Backward compatibility (structura veche):**\n```\ndata: {\n  service: {  // SINGULAR - veche structură\n    id: 'tr2508-00001',\n    name: 'Consultatie',\n    duration: '30'  // string în vechea structură\n  }\n}\n```\n\n### Pentru Patients:\n\n```\ndata: {\n  patientName: 'Maria Ionescu',\n  patientPhone: '0712345678',\n  patientEmail: 'maria@example.com',\n  cnp: '1234567890123',\n  birthDate: '1990-01-15',\n  address: '...',\n  ...\n}\n```\n\n### Pentru Plans și Dental-Charts:\n\n```\ndata: {\n  patientId: 'pa2508-00015',  // REQUIRED pentru queries!\n  status: 'accepted',\n  ...\n}\n```\n\n## BEST PRACTICES:\n\n1. ✅ **Folosește întotdeauna dot notation** pentru nested fields în queries\n2. ✅ **NU include** businessId, locationId, resourceId când creezi resurse\n3. ✅ **Pentru appointments** folosește noua structură cu `services` (array)\n4. ✅ **Pentru date range** folosește startDate/endDate ca top-level params\n5. ✅ **Verifică documentația** pentru fiecare tip de resursă pentru structura exactă\n\n## GREȘELI COMUNE:\n\n❌ Să incluzi resourceId când creezi resurse\n❌ Să folosești obiect nested în params în loc de dot notation\n❌ Să cauți `data.startDate` în loc de `startDate` (top-level)\n❌ Să folosești singular `service` în loc de plural `services` pentru noile appointments\n❌ Să cauți planuri direct după nume pacient (trebuie mai întâi patientId)\n",
  "metadata": {
    "businessType": "dental",
    "version": "2.0.0",
    "lastUpdated": "2025-10-16",
    "type": "data-field-structure",
    "documentId": "dental-data-field-structure",
    "source": "dental-knowledge-base"
  }
}
